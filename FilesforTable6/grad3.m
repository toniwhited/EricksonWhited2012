%subroutine to compute gradient matrix.


function[dvdc] = grad3(a,neq);


dvdc1=zeros(neq,1);
dvdc2=zeros(neq,1);
dvdc3=zeros(neq,1);
dvdc4=zeros(neq,1);
dvdc5=zeros(neq,1);
dvdc6=zeros(neq,1);
dvdc7=zeros(neq,1);
dvdc8=zeros(neq,1);
dvdc9=zeros(neq,1);


dvdc1(1,1)=-2*a(1,1)*a(2,1);
dvdc1(2,1)=-a(2,1);
dvdc1(3,1)=0;
dvdc1(4,1)=-2*a(1,1)*a(5,1);
dvdc1(5,1)=-a(5,1);
dvdc1(6,1)=-3*(a(1,1).^2)*a(6,1)-3*a(2,1)*a(3,1);
dvdc1(7,1)=-2*a(1,1)*(a(6,1)+a(2,1)*a(4,1));
dvdc1(8,1)=-a(6,1)-3*a(2,1)*a(4,1);
dvdc1(9,1)=0;
dvdc1(10,1)=-3*(a(1,1).^2)*a(5,1);
dvdc1(11,1)=-4*(a(1,1).^3)*a(9,1)-12*a(1,1)*a(5,1)*a(3,1)...
               -4*a(2,1)*a(8,1);
dvdc1(12,1)=-3*(a(1,1).^2)*(a(9,1)+a(5,1)*a(4,1))...
               -3*a(5,1)*a(3,1);
dvdc1(13,1)=-2*a(1,1)*(a(9,1)+3*a(5,1)*a(4,1)+a(2,1)*a(7,1));
dvdc1(14,1)=-(a(9,1)+6*a(5,1)*a(4,1)+4*a(2,1)*a(7,1));


dvdc2(1,1)=-(a(1,1).^2);
dvdc2(2,1)=-a(1,1);
dvdc2(3,1)=-1;
dvdc2(4,1)=0;
dvdc2(5,1)=0;
dvdc2(6,1)=-3*a(1,1)*a(3,1);
dvdc2(7,1)=-(a(1,1).^2)*a(4,1)-a(3,1);
dvdc2(8,1)=-3*a(1,1)*a(4,1);
dvdc2(9,1)=0;
dvdc2(10,1)=0;
dvdc2(11,1)=-4*a(1,1)*a(8,1);
dvdc2(12,1)=-a(8,1);
dvdc2(13,1)=-(a(1,1).^2)*a(7,1);
dvdc2(14,1)=-4*a(1,1)*a(7,1);


dvdc3(1,1)=-1;
dvdc3(2,1)=0;
dvdc3(3,1)=0;
dvdc3(4,1)=0;
dvdc3(5,1)=0;
dvdc3(6,1)=-3*a(1,1)*a(2,1);
dvdc3(7,1)=-(a(2,1)+a(4,1));
dvdc3(8,1)=0;
dvdc3(9,1)=0;
dvdc3(10,1)=0;
dvdc3(11,1)=-6*(a(1,1).^2)*a(5,1);
dvdc3(12,1)=-3*a(1,1)*a(5,1);
dvdc3(13,1)=-(a(5,1)+a(7,1));
dvdc3(14,1)=0;


dvdc4(1,1)=0;
dvdc4(2,1)=0;
dvdc4(3,1)=-1;
dvdc4(4,1)=0;
dvdc4(5,1)=0;
dvdc4(6,1)=0;
dvdc4(7,1)=-(a(1,1).^2)*a(2,1)-a(3,1);
dvdc4(8,1)=-3*a(1,1)*a(2,1);
dvdc4(9,1)=0;
dvdc4(10,1)=0;
dvdc4(11,1)=0;
dvdc4(12,1)=-(a(1,1).^3)*a(5,1)-a(8,1);
dvdc4(13,1)=-3*(a(1,1).^2)*a(5,1);
dvdc4(14,1)=-6*a(1,1)*a(5,1);


dvdc5(1,1)=0;
dvdc5(2,1)=0;
dvdc5(3,1)=0;
dvdc5(4,1)=-(a(1,1).^2);
dvdc5(5,1)=-a(1,1);
dvdc5(6,1)=0;
dvdc5(7,1)=0;
dvdc5(8,1)=0;
dvdc5(9,1)=-1;
dvdc5(10,1)=-(a(1,1).^3);
dvdc5(11,1)=-6*(a(1,1).^2)*a(3,1);
dvdc5(12,1)=-(a(1,1).^3)*a(4,1)-3*a(1,1)*a(3,1);
dvdc5(13,1)=-3*(a(1,1).^2)*a(4,1)-a(3,1);
dvdc5(14,1)=-6*a(1,1)*a(4,1);


dvdc6(1,1)=0;
dvdc6(2,1)=0;
dvdc6(3,1)=0;
dvdc6(4,1)=0;
dvdc6(5,1)=0;
dvdc6(6,1)=-(a(1,1).^3);
dvdc6(7,1)=-(a(1,1).^2);
dvdc6(8,1)=-a(1,1);
dvdc6(9,1)=0;
dvdc6(10,1)=0;
dvdc6(11,1)=0;
dvdc6(12,1)=0;
dvdc6(13,1)=0;
dvdc6(14,1)=0;


dvdc7(1,1)=0;
dvdc7(2,1)=0;
dvdc7(3,1)=0;
dvdc7(4,1)=0;
dvdc7(5,1)=0;
dvdc7(6,1)=0;
dvdc7(7,1)=0;
dvdc7(8,1)=0;
dvdc7(9,1)=-1;
dvdc7(10,1)=0;
dvdc7(11,1)=0;
dvdc7(12,1)=0;
dvdc7(13,1)=-(a(1,1).^2)*a(2,1)-a(3,1);
dvdc7(14,1)=-4*a(1,1)*a(2,1);


dvdc8(1,1)=0;
dvdc8(2,1)=0;
dvdc8(3,1)=0;
dvdc8(4,1)=0;
dvdc8(5,1)=0;
dvdc8(6,1)=0;
dvdc8(7,1)=0;
dvdc8(8,1)=0;
dvdc8(9,1)=0;
dvdc8(10,1)=-1;
dvdc8(11,1)=-4*a(1,1)*a(2,1);
dvdc8(12,1)=-(a(2,1)+a(4,1));
dvdc8(13,1)=0;
dvdc8(14,1)=0;


dvdc9(1,1)=0;
dvdc9(2,1)=0;
dvdc9(3,1)=0;
dvdc9(4,1)=0;
dvdc9(5,1)=0;
dvdc9(6,1)=0;
dvdc9(7,1)=0;
dvdc9(8,1)=0;
dvdc9(9,1)=0;
dvdc9(10,1)=0;
dvdc9(11,1)=-(a(1,1).^4);
dvdc9(12,1)=-(a(1,1).^3);
dvdc9(13,1)=-(a(1,1).^2);
dvdc9(14,1)=-a(1,1);

dvdc=[dvdc1,dvdc2,dvdc3,dvdc4,dvdc5,dvdc6,dvdc7,dvdc8,dvdc9];
