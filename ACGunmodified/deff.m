%subroutine to define the f vector.


function[f] = deff(a,mmm,eestim,nneeqq,wf);

f=zeros(1,nneeqq);


f(:,1)=mmm{1}-(a(1,1).^2)*a(2,1)-a(3,1);
f(:,2)=mmm{2}-a(1,1)*a(2,1);
f(:,3)=mmm{3}-a(2,1)-a(4,1);
f(:,4)=mmm{4}-(a(1,1).^2)*a(5,1);
f(:,5)=mmm{5}-a(1,1)*a(5,1);


if eestim>1;


f(:,6)=mmm{6}-(a(1,1).^3)*a(6,1)-3*a(1,1)*a(2,1)*a(3,1);
f(:,7)=mmm{7}-(a(1,1).^2)*(a(6,1)+a(2,1)*a(4,1))...
                    -a(3,1)*(a(2,1)+a(4,1));
f(:,8)=mmm{8}-a(1,1)*a(6,1)-3*a(1,1)*a(2,1)*a(4,1);


end;
if eestim>2;


f(:,9)=mmm{9}-a(5,1)-a(7,1);


f(:,10)=mmm{10}-(a(1,1).^3)*a(5,1)-a(8,1);


f(:,11)=mmm{11}-(a(1,1).^4)*a(9,1)-6*(a(1,1).^2)*a(5,1)*a(3,1)...
                -4*a(1,1)*a(2,1)*a(8,1);


f(:,12)=mmm{12}-(a(1,1).^3)*(a(9,1)+a(5,1)*a(4,1))...
                       -3*a(1,1)*a(5,1)*a(3,1)-a(8,1)*(a(2,1)+a(4,1));


f(:,13)=mmm{13}-(a(1,1).^2)*(a(9,1)+3*a(5,1)*a(4,1)+a(2,1)*a(7,1))...
                     -a(3,1)*(a(5,1)+a(7,1));


f(:,14)=mmm{14}-a(1,1)*(a(9,1)+6*a(5,1)*a(4,1)+4*a(2,1)*a(7,1));


end;
if eestim>3;


f(:,15)=mmm{15}-(a(1,1).^4)*a(6,1)-6*(a(1,1).^2)*a(2,1)*a(3,1)...
                           -a(10,1);


f(:,16)=mmm{16}-a(6,1)-6*a(2,1)*a(4,1)-a(11,1);


f(:,17)=mmm{17}-(a(1,1).^5)*a(12,1)-10*(a(1,1).^3)*a(6,1)*a(3,1)...
                        -10*(a(1,1).^2)*a(5,1)*a(8,1)-5*a(1,1)*a(2,1)*a(10,1);


f(:,18)=mmm{18}-(a(1,1).^4)*(a(12,1)+a(6,1)*a(4,1))...
                            -6*(a(1,1).^2)*(a(6,1)*a(3,1)+a(2,1)*a(3,1)*a(4,1))...
                              -4*a(1,1)*a(5,1)*a(8,1)-a(10,1)*(a(2,1)+a(4,1));


f(:,19)=mmm{19}-(a(1,1).^3)*(a(12,1)+3*a(6,1)*a(4,1)+a(5,1)*a(7,1))...
                               -a(1,1)*(3*a(6,1)*a(3,1)+9*a(2,1)*a(3,1)*a(4,1))...
                               -a(8,1)*(a(5,1)+a(7,1));


f(:,20)=mmm{20}-(a(1,1).^2)*(a(12,1)+6*a(6,1)*a(4,1)...
                                 +4*a(5,1)*a(7,1)+a(2,1)*a(11,1))...
                                  -a(3,1)*(a(6,1)+6*a(2,1)*a(4,1)+a(11,1));


f(:,21)=mmm{21}-a(1,1)*(a(12,1)+10*a(6,1)*a(4,1)...
                                         +10*a(5,1)*a(7,1)+5*a(2,1)*a(11,1));


end;
if eestim>4;


f(:,22)=mmm{22}-(a(1,1).^5)*a(9,1)-10*(a(1,1).^3)*a(5,1)*a(3,1)...
                 -10*(a(1,1).^2)*a(2,1)*a(8,1)-a(13,1);




f(:,23)=mmm{23}-a(9,1)-10*a(5,1)*a(4,1)-10*a(2,1)*a(7,1)-a(14,1);


f(:,24)=mmm{24}-(a(1,1).^6)*a(15,1)...
                -15*(a(1,1).^4)*a(9,1)*a(3,1)...
                -20*(a(1,1).^3)*a(6,1)*a(8,1)...
                -15*(a(1,1).^2)*a(5,1)*a(10,1)...
                -6*a(1,1)*a(2,1)*a(13,1);


f(:,25)=mmm{25}-(a(1,1).^5)*(a(15,1)+a(9,1)*a(4,1))...
                     -10*(a(1,1).^3)*(a(9,1)*a(3,1)+a(5,1)*a(3,1)*a(4,1))...
                     -10*(a(1,1).^2)*(a(6,1)*a(8,1)+a(2,1)*a(8,1)*a(4,1))...
                 -5*a(1,1)*a(5,1)*a(10,1)...
                     -a(13,1)*(a(2,1)+a(4,1));




f(:,26)=mmm{26}...
-(a(1,1).^4)*(a(15,1)+3*a(9,1)*a(4,1)+a(6,1)*a(7,1))...
-6*(a(1,1).^2)*(a(9,1)*a(3,1)+3*a(5,1)*a(3,1)*a(4,1)+a(2,1)*a(3,1)*a(7,1))...
-4*a(1,1)*(a(6,1)*a(8,1)+3*a(2,1)*a(8,1)*a(4,1))...
-a(10,1)*(a(5,1)+a(7,1));




f(:,27)=mmm{27}...
-(a(1,1).^3)*(a(15,1)+6*a(9,1)*a(4,1)+4*a(6,1)*a(7,1)+a(5,1)*a(11,1))...
-a(1,1)*(3*a(9,1)*a(3,1)+18*a(5,1)*a(3,1)*a(4,1)+12*a(2,1)*a(3,1)*a(7,1))...
-a(8,1)*(a(6,1)+6*a(2,1)*a(4,1)+a(11,1));


f(:,28)=mmm{28}...
-(a(1,1).^2)*(a(15,1)+10*a(9,1)*a(4,1)+10*a(6,1)*a(7,1)+5*a(5,1)*a(11,1)...
+a(2,1)*a(14,1))...
-a(3,1)*(a(9,1)+10*a(5,1)*a(4,1)+10*a(2,1)*a(7,1)+a(14,1));


f(:,29)=mmm{29}...
-a(1,1)*(a(15,1)+15*a(9,1)*a(4,1)+20*a(6,1)*a(7,1)+15*a(5,1)*a(11,1)...
+6*a(2,1)*a(14,1));


end;


if wf==0; f=f'; end;
